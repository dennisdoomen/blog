---

title: Getting more out of unit testing in Silverlight
date: '2010-09-24T10:01:00.001+02:00'

tags:
- Silverlight
- Testing
modified_time: '2010-09-24T10:05:44.957+02:00'
blogger_id: tag:blogger.com,1999:blog-15137028.post-774529469277639709
blogger_orig_url: http://www.continuousimprover.com/2010/09/getting-more-out-of-unit-testing-in.html
---

<p>As I already mentioned in my previous post, we're building a line-of-business app using Silverlight 4 and <a href="http://www.dennisdoomen.net/2010/09/some-thoughts-on-wcf-data-services-and.html">WCF Data Services</a>. I really think Silverlight is great for those kind of systems, but since it is based on a different run-time as the full .NET framework, you may wonder what you'll run into when practicing TDD, relying on IoC or using a mocking framework. </p>  <p>Well, both <a href="http://ayende.com/projects/rhino-mocks/downloads.aspx">Rhino Mocks</a> and <a href="http://code.google.com/p/moq/downloads/list">MOQ</a> have a Silverlight version, although I have only used Rhino Mocks myself. Additionally, if you're into IoC containers like me, <a href="http://msdn.microsoft.com/en-us/library/ff678312.aspx">Microsoft Unity 2.0</a> has been working perfectly under Silverlight 4. Here are some additional considerations. </p>  <p>In general, I prefer the <a href="http://fluentassertions.codeplex.com/SourceControl/changeset/view/56541#1194350">Arrange-Act-Assert</a> style for state-based tests such as when specifying the behavior of domain entities or simple framework elements. However, for view models or other code that has a more orchestrational nature I prefer to use a style that more closely resembles <a href="http://haacked.com/archive/2008/08/24/introducing-subspec.aspx">Behavior Driven Design</a>. Consider for example the specifications for a MVVM class.</p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160; [</font><span style="color: "><font style="font-size: 11pt" color="#00008b">TestClass</font></span><font style="font-size: 11pt" color="#000000">]</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">public</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#0000ff">class</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#00008b">ManageRegistrationViewModelSpecs</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160; {</font></font>    <br /><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; [</font><span style="color: "><font style="font-size: 11pt" color="#00008b">TestClass</font></span><font style="font-size: 11pt" color="#000000">]</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">public</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#0000ff">class</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#00008b">When_adding_an_importing_country</font></span><font style="font-size: 11pt" color="#000000"> : </font><span style="color: "><font style="font-size: 11pt" color="#00008b">SpecificationContext</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">private</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#00008b">ManageRegistrationViewModel</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#800080">model</font></span><font style="font-size: 11pt" color="#000000">;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">private</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#00008b">Country</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#800080">countryToAdd</font></span><font style="font-size: 11pt" color="#000000">;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">protected</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#0000ff">override</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#0000ff">void</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">EstablishContext</font></span><font style="font-size: 11pt" color="#000000">()</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#800080">countryToAdd</font></span><font style="font-size: 11pt" color="#000000"> = </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">new</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#00008b">CountryBuilder</font></span><font style="font-size: 11pt" color="#000000">().</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">Build</font></span><font style="font-size: 11pt" color="#000000">();</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#800080">model</font></span><font style="font-size: 11pt" color="#000000"> = </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">new</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#00008b">ManageRegistrationViewModelBuilder</font></span><font style="font-size: 11pt" color="#000000">()</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">WithCountry</font></span><font style="font-size: 11pt" color="#000000">(</font><span style="color: "><font style="font-size: 11pt" color="#800080">countryToAdd</font></span><font style="font-size: 11pt" color="#000000">)</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">Build</font></span><font style="font-size: 11pt" color="#000000">();</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">protected</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#0000ff">override</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#0000ff">void</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">Because</font></span><font style="font-size: 11pt" color="#000000">()</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#800080">model</font></span><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#800080">SelectedCountry</font></span><font style="font-size: 11pt" color="#000000"> = </font><span style="color: "><font style="font-size: 11pt" color="#800080">countryToAdd</font></span><font style="font-size: 11pt" color="#000000">;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#800080">model</font></span><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">AddCountry</font></span><font style="font-size: 11pt" color="#000000">();</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; [</font><span style="color: "><font style="font-size: 11pt" color="#00008b">TestMethod</font></span><font style="font-size: 11pt" color="#000000">]</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">public</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#0000ff">void</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">It_should_add_a_new_importing_country_to_the_model</font></span><font style="font-size: 11pt" color="#000000">()</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#800080">model</font></span><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#800080">ImportingCountries</font></span><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">Should</font></span><font style="font-size: 11pt" color="#000000">().</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">HaveCount</font></span><font style="font-size: 11pt" color="#000000">(1);</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#00008b">ImportingCountryModel</font></span><font style="font-size: 11pt" color="#000000"> countryModel = </font><span style="color: "><font style="font-size: 11pt" color="#800080">model</font></span><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#800080">ImportingCountries</font></span><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">Single</font></span><font style="font-size: 11pt" color="#000000">();</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; countryModel.</font><span style="color: "><font style="font-size: 11pt" color="#800080">Country</font></span><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">Should</font></span><font style="font-size: 11pt" color="#000000">().</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">BeSameAs</font></span><font style="font-size: 11pt" color="#000000">(</font><span style="color: "><font style="font-size: 11pt" color="#800080">countryToAdd</font></span><font style="font-size: 11pt" color="#000000">);</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; countryModel.</font><span style="color: "><font style="font-size: 11pt" color="#800080">LicenseType</font></span><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">Should</font></span><font style="font-size: 11pt" color="#000000">().</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">BeNull</font></span><font style="font-size: 11pt" color="#000000">();</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; countryModel.</font><span style="color: "><font style="font-size: 11pt" color="#800080">RegulatoryAgent</font></span><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">Should</font></span><font style="font-size: 11pt" color="#000000">().</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">BeNull</font></span><font style="font-size: 11pt" color="#000000">();</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; countryModel.</font><span style="color: "><font style="font-size: 11pt" color="#800080">MarketingAuthorizationHolder</font></span><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">Should</font></span><font style="font-size: 11pt" color="#000000">().</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">BeNull</font></span><font style="font-size: 11pt" color="#000000">();</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; countryModel.</font><span style="color: "><font style="font-size: 11pt" color="#800080">TradeName</font></span><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">Should</font></span><font style="font-size: 11pt" color="#000000">().</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">BeEmpty</font></span><font style="font-size: 11pt" color="#000000">();</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; [</font><span style="color: "><font style="font-size: 11pt" color="#00008b">TestMethod</font></span><font style="font-size: 11pt" color="#000000">]</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">public</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#0000ff">void</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">It_should_queue_the_coresponding_command</font></span><font style="font-size: 11pt" color="#000000">()</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#800080">model</font></span><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#800080">PendingChanges</font></span><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">Should</font></span><font style="font-size: 11pt" color="#000000">().</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">HaveCount</font></span><font style="font-size: 11pt" color="#000000">(1);</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#800080">model</font></span><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#800080">PendingChanges</font></span><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">Should</font></span><font style="font-size: 11pt" color="#000000">()       <br /><font style="font-size: 11pt"></font></font></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font face="Calibri"><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">ContainItemsAssignableTo</font></span><font style="font-size: 11pt" color="#000000">&lt;</font><span style="color: "><font style="font-size: 11pt" color="#00008b">AddImportingCountryCommand</font></span><font style="font-size: 11pt" color="#000000">&gt;();</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">var</font></span><font style="font-size: 11pt" color="#000000"> command = (</font><span style="color: "><font style="font-size: 11pt" color="#00008b">AddImportingCountryCommand</font></span><font style="font-size: 11pt" color="#000000">)</font><span style="color: "><font style="font-size: 11pt" color="#800080">model</font></span><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#800080">PendingChanges</font></span><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">Single</font></span><font style="font-size: 11pt" color="#000000">();</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; command.</font><span style="color: "><font style="font-size: 11pt" color="#800080">CountryId</font></span><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">Should</font></span><font style="font-size: 11pt" color="#000000">().</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">Be</font></span><font style="font-size: 11pt" color="#000000">(</font><span style="color: "><font style="font-size: 11pt" color="#800080">countryToAdd</font></span><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#800080">Id</font></span><font style="font-size: 11pt" color="#000000">);</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; [</font><span style="color: "><font style="font-size: 11pt" color="#00008b">TestMethod</font></span><font style="font-size: 11pt" color="#000000">]</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">public</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#0000ff">void</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">It_should_remove_that_country_from_the_list_of_available_countries</font></span><font style="font-size: 11pt" color="#000000">()</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#800080">model</font></span><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#800080">Countries</font></span><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">Should</font></span><font style="font-size: 11pt" color="#000000">().</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">NotContain</font></span><font style="font-size: 11pt" color="#000000">(</font><span style="color: "><font style="font-size: 11pt" color="#800080">countryToAdd</font></span><font style="font-size: 11pt" color="#000000">);</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; [</font><span style="color: "><font style="font-size: 11pt" color="#00008b">TestMethod</font></span><font style="font-size: 11pt" color="#000000">]</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">public</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#0000ff">void</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">It_should_clear_the_selected_country</font></span><font style="font-size: 11pt" color="#000000">()</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#800080">model</font></span><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#800080">SelectedCountry</font></span><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">Should</font></span><font style="font-size: 11pt" color="#000000">().</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">BeNull</font></span><font style="font-size: 11pt" color="#000000">();</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160; }</font></font></p>  <p>Unfortunately, the current <a href="http://www.jeff.wilcox.name/2010/05/new-2010-test-framework/">Silverlight Unit Test</a> runner does not show the name of the outer test class, in this case ManageRegistrationViewModelSpecs, and I haven't found a solution for this yet. So if your list of tests is extensive, you may have some trouble finding the test your interested in. However, one nice trick I found by inspecting the source code of the test runner is that you can apply an [Exclusive] attribute to a particular class. This ensures that the test runner only runs that particular test. For completeness, here is the code of the SpecificationContext base-class I use:</p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160; [</font><span style="color: "><font style="font-size: 11pt" color="#00008b">TestClass</font></span><font style="font-size: 11pt" color="#000000">]</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">public</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#0000ff">class</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#00008b">SpecificationContext</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">private</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#00008b">Exception</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#800080">initializationException</font></span><font style="font-size: 11pt" color="#000000">;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; [</font><span style="color: "><font style="font-size: 11pt" color="#00008b">TestInitialize</font></span><font style="font-size: 11pt" color="#000000">]</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">public</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#0000ff">void</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">TestInitialize</font></span><font style="font-size: 11pt" color="#000000">()</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">try</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#008b8b">EstablishContext</font></span><font style="font-size: 11pt" color="#000000">();</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#008b8b">Because</font></span><font style="font-size: 11pt" color="#000000">();</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">catch</font></span><font style="font-size: 11pt" color="#000000"> (</font><span style="color: "><font style="font-size: 11pt" color="#00008b">Exception</font></span><font style="font-size: 11pt" color="#000000"> exception)</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#800080">initializationException</font></span><font style="font-size: 11pt" color="#000000"> = exception;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; [</font><span style="color: "><font style="font-size: 11pt" color="#00008b">TestMethod</font></span><font style="font-size: 11pt" color="#000000">]</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">public</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#0000ff">void</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">Establish_context_and_because</font></span><font style="font-size: 11pt" color="#000000">()</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">if</font></span><font style="font-size: 11pt" color="#000000"> (</font><span style="color: "><font style="font-size: 11pt" color="#800080">initializationException</font></span><font style="font-size: 11pt" color="#000000"> != </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">null</font></span><font style="font-size: 11pt" color="#000000">)</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">throw</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#800080">initializationException</font></span><font style="font-size: 11pt" color="#000000">;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; [</font><span style="color: "><font style="font-size: 11pt" color="#00008b">TestCleanup</font></span><font style="font-size: 11pt" color="#000000">]</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">public</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#0000ff">void</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">TestCleanup</font></span><font style="font-size: 11pt" color="#000000">()</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#008b8b">CleanupContext</font></span><font style="font-size: 11pt" color="#000000">();</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">protected</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#0000ff">virtual</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#0000ff">void</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">EstablishContext</font></span><font style="font-size: 11pt" color="#000000">() {</font><span style="mso-spacerun: yes"><font style="font-size: 11pt" color="#000000">&#160; </font></span><font style="font-size: 11pt" color="#000000">}</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">protected</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#0000ff">virtual</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#0000ff">void</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">Because</font></span><font style="font-size: 11pt" color="#000000">() { }</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">protected</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#0000ff">virtual</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#0000ff">void</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">CleanupContext</font></span><font style="font-size: 11pt" color="#000000">() { }</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160; }</font></font></p>  <p>You may notice the awkward exception handling code in there. I discovered that the current test runner swallows all exceptions that occur in the method marked with the [TestInitialize] attribute. That's why I explicitly catch every exception that occurs while calling EstablishContext and Because and re-throw it in a dedicated method marked with the [TestMethod] attribute. The full .NET Framework does not have this particular symptom, so It's a Silverlight thingy.</p>  <p>Another tip to improve the testing experience is to disable the tag editor that you get when you launch your test project. Replacing the Application_Startup method of the App class with the following lines quiets it down permanently:</p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">private</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#0000ff">void</font></span><font style="font-size: 11pt" color="#000000">&#160;</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">Application_Startup</font></span><font style="font-size: 11pt" color="#000000">(</font><span style="color: "><font style="font-size: 11pt" color="#0000ff">object</font></span><font style="font-size: 11pt" color="#000000"> sender, </font><span style="color: "><font style="font-size: 11pt" color="#00008b">StartupEventArgs</font></span><font style="font-size: 11pt" color="#000000"> e)</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">var</font></span><font style="font-size: 11pt" color="#000000"> settings = </font><span style="color: "><font style="font-size: 11pt" color="#00008b">UnitTestSystem</font></span><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">CreateDefaultSettings</font></span><font style="font-size: 11pt" color="#000000">();</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; settings.</font><span style="color: "><font style="font-size: 11pt" color="#800080">StartRunImmediately</font></span><font style="font-size: 11pt" color="#000000"> = </font><span style="color: "><font style="font-size: 11pt" color="#0000ff">true</font></span><font style="font-size: 11pt" color="#000000">;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font style="font-size: 11pt" color="#800080">RootVisual</font></span><font style="font-size: 11pt" color="#000000"> = </font><span style="color: "><font style="font-size: 11pt" color="#00008b">UnitTestSystem</font></span><font style="font-size: 11pt" color="#000000">.</font><span style="color: "><font style="font-size: 11pt" color="#008b8b">CreateTestPage</font></span><font style="font-size: 11pt" color="#000000">(settings);</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160; }</font></font></p>  <p>Also, if you apply the Continuous Integration practice, you may want to check out <a href="http://statlight.codeplex.com/">StatLight</a>. I have not managed to get it running myself, but it is supposed to support running Silverlight tests from the command-line or from your favorite build engine.</p>  <p>And finally, if you're really into the testability and object-oriented design principles, you must check out <a href="http://caliburnmicro.codeplex.com/">Caliburn Micro</a>. It's an open-source framework for Silverlight 4, Windows Phone 7 and WPF, and has some excellent concepts for relieving the burden of working with asynchronous code. I've been using it for over two months now and I'm exhilarated about its <a href="http://caliburnmicro.codeplex.com/wikipage?title=IResult%20and%20Coroutines&amp;referringTitle=Documentation">coroutine</a> concept and the <a href="http://caliburnmicro.codeplex.com/wikipage?title=Testing%20Coroutines&amp;referringTitle=Documentation">way</a> you use it in your tests.</p>  