---

title: Defining a reference architecture for Silverlight LOBs
date: '2009-07-29T08:49:00.002+02:00'

tags:
- Architecture
- Silverlight
modified_time: '2010-10-12T09:26:08.676+02:00'
blogger_id: tag:blogger.com,1999:blog-15137028.post-3820706712717136170
blogger_orig_url: http://www.continuousimprover.com/2009/07/defining-reference-architecture-for.html
---

<p><strong>Update October 2010</strong>: I’ve started a new <a href="http://www.dennisdoomen.net/search/label/Silverlight">in-depth series</a> on my current Silverlight 4 Reference Architecture. </p>  <p>Recently I've been catching up on Silverlight by reading <a href="http://www.amazon.com/Pro-Silverlight-C-2008-Windows-Net/dp/1590599497/ref=pd_sim_b_8">Pro Silverlight 2 in C#</a> and the many blogs and articles on Silverlight 3 and I'm seriously impressed. The reason for this sudden interest is the fact that I'm considering Silverlight as an alternative to ASP.NET for building line-of-business applications. Silverlight 2 was promising, but lacked some important features that are required in full-screen Silverlight apps. However, Silverlight 3 has introduced some <a href="http://timheuer.com/blog/archive/2009/03/18/silverlight-3-whats-new-a-guide.aspx">major improvements</a> that convinced me that it is finally ready for replacing ASP.NET for controlled environments.</p>  <p>Since I'm quite fond of Martin Fowler's <a href="http://www.martinfowler.com/articles/designDead.html">approach</a> to Evolutionairy Design, I'd like to have at least a rough idea of where I'm going to in terms of architecture and technology support. Consequently, I've been thinking hard to come up with a list of features and ideas I'd like to consider in a SL architecture. The list is not complete, so I’ll adapt it regularly. But since I assume more people are trying to cross that same bridge, I though sharing my wish list could be useful. </p>  <p><strong>General</strong></p>  <ul>   <li>Simple Design, Test-Driven Development and Refactoring are the foundation of all design and development efforts.</li>    <li>I will explicitly consider every recommendation from the <a href="http://apparch.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=19799">RIA Pocket Guide</a> and make sure they are either included in the design or made part of the product backlog.</li>    <li>I'm seriously considering to use <a href="http://code.google.com/p/moq/">MOQ</a> instead of <a href="http://ayende.com/Blog/archive/2009/02/04/rhino-mocks-3.5-ndash-silverlight.aspx">Rhino Mocks</a>. I've been using Rhino for over two years, but Ayende hasn't reported much development anymore and its Silverlight support is only alpha. MOQ has official Silverlight support and appears to be very active.</li>    <li>I'll start with Visual Studio 2008 SP1, but will switch to Visual Studio 2010 Beta 2 when it arrives and has support for RIA Services.</li> </ul>  <p><strong>The Application Server</strong></p>  <ul>   <li>RIA Services to expose DTOs to the client. I have thought long and hard about how to fit RIA Services in a system, but I refuse to directly expose the domain model and pollute it with explicit choices about how far RIA should serialize a my domain entities. Therefore, I will expose DTOs only, even though I loose the automatic propagation of validation logic to the client.</li>    <li>A Domain Model roughly designed according to <a href="http://domaindrivendesign.org/">DDD</a> principles where cross-aggregate logic will be covered by Domain Services.</li>    <li>Obviously I'll use NHibernate accompanied by <a href="https://sourceforge.net/projects/nhibernate/files">LINQ</a> and <a href="http://wiki.fluentnhibernate.org/show/HomePage">Fluent NHibernate</a> (download them from <a href="http://www.dennisdoomen.net/2009/07/nhibernate-210-ga-with-linq-and-fluent.html">here</a> if you want a set of compatible builds).</li>    <li>I'll still use the Repository pattern to hide any LINQ-to-NHibernate limitations. They will be exposed through an NHibernateObjectContext that serves as the unit-of-work and essentially wraps the ISession</li>    <li>I'm considering to introduce <a href="http://www.udidahan.com/2009/06/14/domain-events-salvation/">Domain Events</a> to keep any infrastructural logic from poluting the domain model. However, I'm not sure how worthwhile this purist approach will be.</li>    <li>I've spend too much time hand-coding this translators in earlier projects, so I'm open to try out <a href="http://automapper.codeplex.com/">AutoMapper</a> for this. </li>    <li>As usual, I'll use Enterprise Library 4.1 on the backend for Policy Injection, Exception Handling, Validation and Logging. I'm not sure when <a href="http://entlib.codeplex.com/Wiki/View.aspx?title=EntLib5%20Developer%20Notes">version 5.0</a> will arrive, but I like its feature set. If it arrives in time, I will consider migrating (the 3.0 -&gt; 4.1 migration was trivial).</li> </ul>  <p><strong>The Silverlight client</strong></p>  <ul>   <li>The use of Regions and Views such as the <a href="http://msdn.microsoft.com/en-us/library/dd458868.aspx">Composite Application Guidance</a> (CAG) is providing, but without the concept of modules. The <a href="http://msdn.microsoft.com/en-us/library/bb264518.aspx">Web Client Software Factory</a> had a similar concept, but I never found real use for them anyway.</li>    <li>An Event Aggregator to allow communication between views and other components without them needing a direct reference to eachother. I'm not yet sure which one I'll use. CAG has a <a href="http://msdn.microsoft.com/en-us/library/dd458915.aspx">nice</a> one, but Jeremy's <a href="http://codebetter.com/blogs/jeremy.miller/archive/2009/07/23/how-i-m-using-the-event-aggregator-pattern-in-storyteller.aspx">version</a> might be interesting as well. </li>    <li>Dependency Injection through <a href="http://msdn.microsoft.com/en-us/library/dd362339.aspx">Unity for Silverlight</a>. </li>    <li>I wish there was a Policy Injection framework for Silverlight as well...</li>    <li>RIA Services also adds a very nice mechanism for sharing code between the server and the Silverlight client, but I'm not sure yet how I'll use it. I think this is something that will become clear during development.</li>    <li>The RIA DomainContext will be accessed through an interface so that the ViewModel classes can be unit tested properly without any dependency on RIA.</li>    <li>INotifyPropertyChanged using lambda expressions instead of literal property names</li>    <li><a href="http://msdn.microsoft.com/en-us/magazine/dd419663.aspx">Model-View-ViewModel</a> (essentially Presentation Model with INotifyPropertyChanged and INotifyCollectionChanged support)</li>    <li>Some mechanism for hooking Silverlight controls to ICommand objects. I'm not sure yet whether I like the <a href="http://msdn.microsoft.com/en-us/library/dd458928.aspx">CAG implementation</a>, so I may have to find an alternative.</li>    <li><a href="http://silverlight.net/samples/sl2/toolkitcontrolsamples/run/default.html">Silverlight Toolkit</a> and Telerik's <a href="http://www.telerik.com/products/silverlight.aspx">RadControls for Silverlight</a></li>    <li>Deep linking with SL3's <a href="http://timheuer.com/blog/archive/2009/03/22/silverlight-navigation-framework-and-uri-routing.aspx">Navigation Framework</a></li> </ul>  