---

title: A new year with a new release of Fluent Assertions
date: '2011-01-03T08:06:00.000+01:00'

tags:
- Fluent Assertions
- dotnetmag
- C#
- Testing
modified_time: '2011-01-03T08:06:40.601+01:00'
blogger_id: tag:blogger.com,1999:blog-15137028.post-6926630556563576176
blogger_orig_url: http://www.continuousimprover.com/2011/01/new-year-with-new-release-of-fluent.html
---

Christmas usually means a week off and a whole lot of free time between the social obligations and spending some quality time with my wife and daughter. That’s why I decided to get rid of some of the backlog items for the next version of Fluent Assertions. And I’m done, <a href="http://fluentassertions.codeplex.com/releases/view/58053">version 1.3.0</a> is a fact. <br /><br /><b>New Features</b><br /><ul><li>Introduced a new set of extension methods for asserting that events were raised with the appropriate data. With his permission, I borrowed, adapted and integrated the code from <a href="http://mendeltsiebenga.com/">Mendelt Siebenga</a>’s original <a href="https://github.com/Mendelt/EMo">EMo</a> project. I’ll write up a separate post on how to use this in Silverlight testing. </li><li><span style="font-family: Consolas;">BeOfType&lt;T&gt;()</span> and <span style="font-family: Consolas;">BeAssignableTo&lt;T&gt;()</span> are available for all reference types. Before this, they were only available on the <span style="font-family: Consolas;">ObjectAssertions</span> class.</li><li>Added an <span style="font-family: Consolas;">OnlyContain()</span> method to the collection assertions that takes a lambda expression and ensures that the collection only contains items matching the predicate. </li><li>Added an overload of Contain() to the collection assertions that takes both an <span style="font-family: Consolas;">IEnumerable&lt;T&gt;</span> and a <span style="font-family: Consolas;">params</span> array. I regularly ran into the situation that I wanted to check if a particular new item was added to a collection. With this overload, you no longer need to create a temporary list that contains both the original collection and the newly added items.</li><li>Added support for <span style="font-family: Consolas;">ShouldHave().SharedProperties().EqualTo(otherObject)</span>. This saved me a lot of work when asserting that some DTO-entity conversion was implemented correctly. Before I had to exclude all the properties that I didn’t want to include in the DTO, or swap the calling order, neither improving the readability. But since you still may end up wanting to exclude a particular property, I also added an additional <span style="font-family: Consolas;">But(x =&gt; x.Property)</span> method that can be combined with <span style="font-family: Consolas;">AllProperties()</span> and <span style="font-family: Consolas;">SharedProperties().</span></li></ul><br /><b>Breaking Changes</b> <br /><ul><li>Changed the way test framework assemblies are found so that they are not relying on specific versions anymore. In fact, I introduced separate versions for .NET 3.5 and .NET 4.0 that both support all test frameworks. They will automatically find the test framework assembly, but you can force it using an <span style="font-family: Consolas;">&lt;appSetting&gt;</span>.</li><li>Switched to Silverlight 4 for the Silverlight version of Fluent Assertions. </li><li>Renamed the <span style="font-family: Consolas;">Assertions</span> base-class to <span style="font-family: Consolas;">ReferenceTypeAssertions</span> because it better explains its purpose.</li><li><span style="font-family: Consolas;">BeOfType&lt;T&gt;()</span> was not properly checking that the subject was of the exact same type rather than a subclass. I fixed this, but it may break existing unit tests. </li></ul><br /><b>Improvements/Bugs</b> <br /><ul><li>Signed all assemblies with a strong name. </li><li>Added some missing XML comments. </li><li>Improved the extensibility by exposing the subject-under-test via a public <span style="font-family: Consolas;">Subject</span> property and making all contructors protected. </li><li>If the exception message is shorter than the expected one specified using <span style="font-family: Consolas;">WithMessage()</span>, but starts with the same text, it was not detected as a difference. </li><li>Fixed a <span style="font-family: Consolas;">NullReferenceException</span> when calling <span style="font-family: Consolas;">ObjectAssertions().Be()</span> on a null object. </li><li><span style="font-family: Consolas;">As&lt;T&gt;()</span> uses a type safe-cast now so that you can do stuff like <span style="font-family: Consolas;">someObject.As&lt;SomeType&gt;().ShouldNotBeNull();</span> </li><li>Fixed a bug that caused the property comparison assertions to ignore internal or base-class properties.</li></ul>I’ve also updated the <a href="http://fluentassertions.codeplex.com/documentation">documentation</a> to include these changes and completed it with some missing information on the property comparison features that I introduced in version 1.2.0.