---

title: 'Microservices: The State of the Union'
date: '2016-06-23T07:54:00.001+02:00'

tags:
- microservices
- qcon
modified_time: '2017-06-24T10:50:00.532+02:00'
blogger_id: tag:blogger.com,1999:blog-15137028.post-1463623145975693130
blogger_orig_url: http://www.continuousimprover.com/2016/06/microservices-state-of-union.html
---

<p>After attending a full-day track with multiple sessions and open-spaces on microservices at QCon New York, it is clear that this technique took flight since I first heard about that at the same conference in 2014. A lot of companies made the jump to solve their technical and organizational scaling issues, including Uber, Amazon and Netflix. And many of them used QCon to share their experiences. This is a random list of thoughts, observations and ideas from that day. <ul> <li>A lot of my <a href="http://www.continuousimprover.com/2014/06/qcon-new-york-day-1-micro-services-team.html">concerns from that time</a> seem to have been resolved by the industry. It's incredible how many (open-source) libraries, products and tools have emerged since then. <a href="http://kafka.apache.org/">Kafka</a> seems to be big one here. <br> <li>Container technology seem to have become a crucial element in a successful migration to microservices. Some would even call this a disrupting technology that changes the way we build software. Deployment times went from months, to days, to minutes. But apparently the next big thing is <a href="http://martinfowler.com/articles/serverless.html">Serverless Architecture</a> . <a href="https://aws.amazon.com/lambda/">AWS Lambda</a> and <a href="https://azure.microsoft.com/nl-nl/services/functions/">Azure Functions</a> are examples of that. <br> <li>Domain Driven Design is becoming the de-facto technique for building microservices. You can see that in this nice definition: "A loosely coupled service-oriented architecture defined by bounded contexts". Event the DDD statement that if you have need to know too much about surrounding services, you probably have your bounded context wrong, applies to microservices. Unfortunately, according to an open space discussion, defining those boundaries is the most complex task.<br> <li>One of the next challenges the community is expected to resolve is the complexity of authorization, security groups, network partition and such. <br></li></ul> <ul> <li>Something that <a href="https://qconnewyork.com/ny2016/speakers/daniel-bryant">Daniel Bryant</a> noted (and something I observed myself while talking to the people at QCon) is that microservices is becoming the new the solution-to-all-problems. This is dangerous and leads to cargo culting. <br> <li>Microservices is not just about technology. It also has a significant effect on the organization. In fact, as the workshop on the last day showed (about which a blog post will follow), these two go hand in hand.<br> <li>Failure testing by injecting catastrophic events using <a href="https://github.com/Netflix/SimianArmy/wiki/Chaos-Monkey">Chaos Monkey</a> (part of the <a href="https://github.com/Netflix/SimianArmy">Simian Army</a>), <a href="http://techblog.netflix.com/2014/10/fit-failure-injection-testing.html">Failure Injection Testing</a> and <a href="https://developer.ibm.com/open/gremlin/">Gremlin</a> seem to become a commodity.<br> <li>For obvious reasons Continuous Delivery is not a luxury anymore, it has become a prerequisite.<br> <li>Version-aware routing and discovery of services through an API gateway is being used by all those that moved to microservices and seem to be a prerequisite. Such a gateway also provides a service registry to find services by name and version and get a IP and port. Smart Pipes are supposed to make that even more transparent. Examples of gateways that were used included <a href="https://getkong.org/">Kong</a>, <a href="http://apigee.com/about/">Apigee</a>, <a href="https://aws.amazon.com/api-gateway/">AWS API Gateway</a> and Mulesoft.<br> <li>With respect to communication protocols, the consensus is to use JSON over HTTP for external/public interfaces (which makes it easy to consume by all platforms), and using more bandwidth-optimized protocols like <a href="http://thrift-tutorial.readthedocs.io/en/latest/thrift-stack.html">thrift</a>, Protobuf, Avro or SBE internally. XML has been ruled out by all parties. Next to that, <a href="http://swagger.io/">Swagger</a> (through <a href="https://github.com/domaindrivendev/Swashbuckle">Swashbuckle</a> for .NET) or <a href="https://github.com/datawire/quark">DataWire Quark</a> were mentioned for documenting the interfaces. Next to that, developers proposed to have the owning team build a reference driver for every service. Consumers can use that to understand the semantics of the service.<br></li></ul> <ul> <li>Even a deployment strategy has formed. I've heard multiple stating that you should deploy the existing code with either a new/updated platform stack or new dependencies, but not both. Consequently, deploying new code should happen without changing the dependencies or platform. This should reduce the feedback loop for diagnosing deployment problems. <br> <li>A common recurring problem is overloading the network, also called retry storming because each service has its own timeout and retry logic causes an exponential retry duplication. A proposed solution is introducing a cascading timeout budget. Using event publishing rather than RPC surely can prevent this problem altogether. <br></li></ul> <ul> <li>If you have many services, you might eventually run into connection timeout issues. So using shared containers allows reusing connection. Don't use connection pooling either. Next to that, if services have been replicated for scale-out purposes, you should only retry on a different connection to a different instance. <br> <li>Regressions don't surface immediately apparently, so all of the speakers agreed that <a href="http://martinfowler.com/bliki/CanaryRelease.html">canary testing</a> is the only reliable way to find them.<br> <li>A big-bang replacement is the worst thing you can do, and most of the successful companies used a form of the <a href="http://www.martinfowler.com/bliki/StranglerApplication.html">Strangler pattern</a> to replace a part of the functionality. <br> <li>A nice pattern that was mentioned a couple of times is that every service exposes a /test end-point so that be used to verify versions and dependencies during canary testing. </li></ul> <p>So what do you think? Are you already trying or operating microservices? If yes, any practices to share? If not, are you planning to? Love to hear your thoughts by commenting below. Oh, and follow me at <a href="https://twitter.com/ddoomen">@ddoomen</a> to get regular updates on my everlasting quest for better solutions.</p>