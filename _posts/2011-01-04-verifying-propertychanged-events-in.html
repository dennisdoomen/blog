---

title: Verifying PropertyChanged events in Silverlight using Fluent Assertions
date: '2011-01-04T08:19:00.000+01:00'

tags:
- Fluent Assertions
- dotnetmag
- Silverlight
- Testing
modified_time: '2011-04-12T08:06:51.543+02:00'
blogger_id: tag:blogger.com,1999:blog-15137028.post-161199606401081573
blogger_orig_url: http://www.continuousimprover.com/2011/01/verifying-propertychanged-events-in.html
---

<p>Yesterday, I <a href="http://www.dennisdoomen.net/2011/01/new-year-with-new-release-of-fluent.html">blogged</a> about the newest release of <a href="http://fluentassertions.codeplex.com/">Fluent Assertions</a> for .NET and Silverlight and promised to demonstrate the new <a href="http://fluentassertions.codeplex.com/documentation">event monitoring syntax</a>. Since I’m a Silverlight addict, I decided to show you an example of a MVVM unit test when using the traditional <font face="Consolas">Assert</font> class and the same example using Fluent Assertions. </p> <p>Let’s start with the traditional example first. Notice the BDD-style I’m using here. If you want to learn more about it, check out my <a href="http://www.dennisdoomen.net/2010/09/getting-more-out-of-unit-testing-in.html">previous</a> post on unit testing in Silverlight.</p><pre style="line-height: normal; font-family: "><font color="#000000"><font size="2" face="Verdana">[</font></font><font size="2"><font face="Verdana"><span style="color: "><font color="#00008b">TestClass</font></span><font color="#000000">]</font><br><span style="color: "><font color="#0000ff">public</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#0000ff">class</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#00008b">When_activating</font></span><font color="#000000"> : </font><span style="color: "><font color="#00008b">SpecificationContext</font></span><br></font></font><font size="2"><font face="Verdana"><font color="#000000">{<br>&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">private</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#00008b">FindActivitiesViewModel</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#800080">model</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">;<br>&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">private</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#00008b">IEnumerable</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#00008b">Product</font></span><font color="#000000">&gt; </font><span style="color: "><font color="#800080">products</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">;<br>&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">private</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#00008b">IEnumerable</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#00008b">Country</font></span><font color="#000000">&gt; </font><span style="color: "><font color="#800080">countries</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">;<br>&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">private</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#0000ff">readonly</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#00008b">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000">&gt; </font><span style="color: "><font color="#800080">changedProperties</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#00008b">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#0000ff">string</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">&gt;();<br> <br>&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">protected</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#0000ff">override</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#008b8b">EstablishContext</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#800080">model</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#00008b">FindActivitiesViewModel</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">();<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#800080">model</font></span><font color="#000000">.</font><span style="color: "><font color="#ff00ff">PropertyChanged</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#008b8b">+=</font></span><font color="#000000"> (sender, args) =&gt; <br>              </font><span style="color: "><font color="#800080">changedProperties</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">Add</font></span><font color="#000000">(args.</font><span style="color: "><font color="#800080">PropertyName</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">);<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#800080">products</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">new</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">[]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#00008b">ProductBuilder</font></span><font color="#000000">().</font><span style="color: "><font color="#008b8b">Named</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">"Trucks"</font></span><font color="#000000">).</font><span style="color: "><font color="#008b8b">Build</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">(),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#00008b">ProductBuilder</font></span><font color="#000000">().</font><span style="color: "><font color="#008b8b">Named</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">"Cars"</font></span><font color="#000000">).</font><span style="color: "><font color="#008b8b">Build</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; };<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#800080">countries</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">new</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">[]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#00008b">CountryBuilder</font></span><font color="#000000">().</font><span style="color: "><font color="#008b8b">Named</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">"Netherlands"</font></span><font color="#000000">).</font><span style="color: "><font color="#008b8b">Build</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">(),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#00008b">CountryBuilder</font></span><font color="#000000">().</font><span style="color: "><font color="#008b8b">Named</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">"Belgium"</font></span><font color="#000000">).</font><span style="color: "><font color="#008b8b">Build</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">(),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#00008b">CountryBuilder</font></span><font color="#000000">().</font><span style="color: "><font color="#008b8b">Named</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">"Luxemburg"</font></span><font color="#000000">).</font><span style="color: "><font color="#008b8b">Build</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; };<br>&nbsp;&nbsp;&nbsp; }<br> <br>&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">protected</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#0000ff">override</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#008b8b">Because</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#800080">model</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">OnActivate</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">();<br>&nbsp;&nbsp;&nbsp; }<br> <br>&nbsp;&nbsp;&nbsp; [</font><span style="color: "><font color="#00008b">TestMethod</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">]<br>&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">public</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#008b8b">It_should_expose_all_countries_sorted_by_name</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#00008b">CollectionAssert</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">AreEqual</font></span><font color="#000000">(<br>           </font></font></font><font size="2"><font face="Verdana"><span style="color: "><font color="#800080">countries</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">OrderBy</font></span><font color="#000000">(c =&gt; c.</font><span style="color: "><font color="#800080">Name</font></span><font color="#000000">).</font><span style="color: "><font color="#008b8b">ToArray</font></span><font color="#000000">(), </font><span style="color: "><font color="#800080">model</font></span><font color="#000000">.</font><span style="color: "><font color="#800080">Countries</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">ToArray</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">());<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#00008b">CollectionAssert</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">Contains</font></span><font color="#000000">(</font><span style="color: "><font color="#800080">changedProperties</font></span><font color="#000000">, </font><span style="color: "><font color="#a31515">"Countries"</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">);<br>&nbsp;&nbsp;&nbsp; }<br> <br>&nbsp;&nbsp;&nbsp; [</font><span style="color: "><font color="#00008b">TestMethod</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">]<br>&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">public</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#008b8b">It_should_expose_all_products_sorted_by_name</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#00008b">CollectionAssert</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">AreEqual</font></span><font color="#000000">(<br>           </font></font></font><font size="2"><font face="Verdana"><span style="color: "><font color="#800080">products</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">OrderBy</font></span><font color="#000000">(p =&gt; p.</font><span style="color: "><font color="#800080">Name</font></span><font color="#000000">).</font><span style="color: "><font color="#008b8b">ToArray</font></span><font color="#000000">(), </font><span style="color: "><font color="#800080">model</font></span><font color="#000000">.</font><span style="color: "><font color="#800080">Products</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">ToArray</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">());<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#00008b">CollectionAssert</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">Contains</font></span><font color="#000000">(</font><span style="color: "><font color="#800080">changedProperties</font></span><font color="#000000">, </font><span style="color: "><font color="#a31515">"Products"</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">);<br>&nbsp;&nbsp;&nbsp; }<br> <br>&nbsp;&nbsp;&nbsp; [</font><span style="color: "><font color="#00008b">TestMethod</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">]<br>&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">public</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#008b8b">It_should_not_expose_search_results_yet</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#00008b">Assert</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">AreEqual</font></span><font color="#000000">(0, </font><span style="color: "><font color="#800080">model</font></span><font color="#000000">.</font><span style="color: "><font color="#800080">FoundActivities</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">Count</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">());<br>&nbsp;&nbsp;&nbsp; }<br> <br>&nbsp;&nbsp;&nbsp; [</font><span style="color: "><font color="#00008b">TestMethod</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">]<br>&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">public</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#008b8b">It_should_not_have_an_initial_selection</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#00008b">Assert</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">IsNull</font></span><font color="#000000">(</font><span style="color: "><font color="#800080">model</font></span><font color="#000000">.</font><span style="color: "><font color="#800080">SelectedCountry</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#00008b">Assert</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">IsNull</font></span><font color="#000000">(</font><span style="color: "><font color="#800080">model</font></span><font color="#000000">.</font><span style="color: "><font color="#800080">SelectedProduct</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">);<br>&nbsp;&nbsp;&nbsp; }<br> <br>&nbsp;&nbsp;&nbsp; [</font><span style="color: "><font color="#00008b">TestMethod</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">]<br>&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">public</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#008b8b">It_should_not_be_possible_to_search</font></span></font></font><font size="2"><font face="Verdana"><font color="#000000">()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#00008b">Assert</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">IsFalse</font></span><font color="#000000">(</font><span style="color: "><font color="#800080">model</font></span><font color="#000000">.</font><span style="color: "><font color="#800080">CanSearch</font></span></font></font><font color="#000000" size="2" face="Verdana">);<br>&nbsp;&nbsp;&nbsp; }<br>}</font></pre><br /><p>Pay some attention to the way I’m verifying that the property changed events were raised, and note the superfluous usage of <font face="Consolas">ToArray()</font> when comparing collections. Why on earth did MS decide to have <font face="Consolas">CollectionAssert.AreEqual()</font> take an <font face="Consolas">ICollection</font> instead of an <font face="Consolas">IEnumerable</font>?</p><br /><p>Anyway, let’s see the equivalent example using Fluent Assertions.</p><pre style="line-height: normal; font-family: "><font color="#000000"><font size="2" face="Verdana">[</font></font><font face="Verdana"><font size="2"><span style="color: "><font color="#00008b">TestClass</font></span><font color="#000000">]</font><br><span style="color: "><font color="#0000ff">public</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#0000ff">class</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#00008b">When_activating</font></span><font color="#000000"> : </font><span style="color: "><font color="#00008b">SpecificationContext</font></span><br></font></font><font face="Verdana"><font size="2"><font color="#000000">{<br>&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">private</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#00008b">FindActivitiesViewModel</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#800080">model</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">;<br>&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">private</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#00008b">IEnumerable</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#00008b">Product</font></span><font color="#000000">&gt; </font><span style="color: "><font color="#800080">products</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">;<br>&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">private</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#00008b">IEnumerable</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#00008b">Country</font></span><font color="#000000">&gt; </font><span style="color: "><font color="#800080">countries</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">;<br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">protected</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#0000ff">override</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#008b8b">EstablishContext</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#800080">model</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#00008b">FindActivitiesViewModel</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#800080">model</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">MonitorEvents</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">();<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#800080">products</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">new</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">[]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#00008b">ProductBuilder</font></span><font color="#000000">().</font><span style="color: "><font color="#008b8b">Named</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">"Trucks"</font></span><font color="#000000">).</font><span style="color: "><font color="#008b8b">Build</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">(),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#00008b">ProductBuilder</font></span><font color="#000000">().</font><span style="color: "><font color="#008b8b">Named</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">"Cars"</font></span><font color="#000000">).</font><span style="color: "><font color="#008b8b">Build</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; };<br> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#800080">countries</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">new</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">[]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#00008b">CountryBuilder</font></span><font color="#000000">().</font><span style="color: "><font color="#008b8b">Named</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">"Netherlands"</font></span><font color="#000000">).</font><span style="color: "><font color="#008b8b">Build</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">(),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#00008b">CountryBuilder</font></span><font color="#000000">().</font><span style="color: "><font color="#008b8b">Named</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">"Belgium"</font></span><font color="#000000">).</font><span style="color: "><font color="#008b8b">Build</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">(),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#00008b">CountryBuilder</font></span><font color="#000000">().</font><span style="color: "><font color="#008b8b">Named</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">"Luxemburg"</font></span><font color="#000000">).</font><span style="color: "><font color="#008b8b">Build</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; };<br>&nbsp;&nbsp;&nbsp; }<br> <br>&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">protected</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#0000ff">override</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#008b8b">Because</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#800080">model</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">OnActivate</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">();<br>&nbsp;&nbsp;&nbsp; }<br> <br>&nbsp;&nbsp;&nbsp; [</font><span style="color: "><font color="#00008b">TestMethod</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">]<br>&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">public</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#008b8b">It_should_expose_all_countries_sorted_by_name</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#800080">model</font></span><font color="#000000">.</font><span style="color: "><font color="#800080">Countries</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">Should</font></span><font color="#000000">().</font><span style="color: "><font color="#008b8b">Equal</font></span><font color="#000000">(</font><span style="color: "><font color="#800080">countries</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">OrderBy</font></span><font color="#000000">(c =&gt; c.</font><span style="color: "><font color="#800080">Name</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#800080">model</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">ShouldRaisePropertyChangeFor</font></span><font color="#000000">(m =&gt; m.</font><span style="color: "><font color="#800080">Countries</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">);<br>&nbsp;&nbsp;&nbsp; }<br> <br>&nbsp;&nbsp;&nbsp; [</font><span style="color: "><font color="#00008b">TestMethod</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">]<br>&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">public</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#008b8b">It_should_expose_all_products_sorted_by_name</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#800080">model</font></span><font color="#000000">.</font><span style="color: "><font color="#800080">Products</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">Should</font></span><font color="#000000">().</font><span style="color: "><font color="#008b8b">Equal</font></span><font color="#000000">(</font><span style="color: "><font color="#800080">products</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">OrderBy</font></span><font color="#000000">(p =&gt; p.</font><span style="color: "><font color="#800080">Name</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#800080">model</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">ShouldRaisePropertyChangeFor</font></span><font color="#000000">(m =&gt; m.</font><span style="color: "><font color="#800080">Products</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">);<br>&nbsp;&nbsp;&nbsp; }<br> <br>&nbsp;&nbsp;&nbsp; [</font><span style="color: "><font color="#00008b">TestMethod</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">]<br>&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">public</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#008b8b">It_should_not_expose_search_results_yet</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#800080">model</font></span><font color="#000000">.</font><span style="color: "><font color="#800080">FoundActivities</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">Should</font></span><font color="#000000">().</font><span style="color: "><font color="#008b8b">BeEmpty</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">();<br>&nbsp;&nbsp;&nbsp; }<br> <br>&nbsp;&nbsp;&nbsp; [</font><span style="color: "><font color="#00008b">TestMethod</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">]<br>&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">public</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#008b8b">It_should_not_have_an_initial_selection</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#800080">model</font></span><font color="#000000">.</font><span style="color: "><font color="#800080">SelectedCountry</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">Should</font></span><font color="#000000">().</font><span style="color: "><font color="#008b8b">BeNull</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#800080">model</font></span><font color="#000000">.</font><span style="color: "><font color="#800080">SelectedProduct</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">Should</font></span><font color="#000000">().</font><span style="color: "><font color="#008b8b">BeNull</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">();<br>&nbsp;&nbsp;&nbsp; }<br> <br>&nbsp;&nbsp;&nbsp; [</font><span style="color: "><font color="#00008b">TestMethod</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">]<br>&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">public</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000">&nbsp;</font><span style="color: "><font color="#008b8b">It_should_not_be_possible_to_search</font></span></font></font><font face="Verdana"><font size="2"><font color="#000000">()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#800080">model</font></span><font color="#000000">.</font><span style="color: "><font color="#800080">CanSearch</font></span><font color="#000000">.</font><span style="color: "><font color="#008b8b">Should</font></span><font color="#000000">().</font><span style="color: "><font color="#008b8b">BeFalse</font></span></font></font><font color="#000000" size="2" face="Verdana">();<br>&nbsp;&nbsp;&nbsp; }<br>}</font></pre>The difference may not be mind blowing. But if you care for intention revealing unit tests as much as I do, you should seriously consider checking out the <a href="http://fluentassertions.codeplex.com/documentation">documentation</a> for the exception throwing and the property comparison assertion extensions. <br />  