---

title: 'My Silverlight 4 Reference Architecture: The Domain Model'
date: '2010-10-13T08:24:00.001+02:00'

tags:
- dotnetmag
- Architecture
- Silverlight
modified_time: '2010-10-13T08:24:42.496+02:00'
blogger_id: tag:blogger.com,1999:blog-15137028.post-6574067186985378127
blogger_orig_url: http://www.continuousimprover.com/2010/10/my-silverlight-4-reference-architecture_13.html
---

<p>The Domain Model is roughly designed according to the <a href="http://domaindrivendesign.org/">DDD</a> principles where cross-aggregate logic is handled by the command handlers instead of the more traditional domain services. One thing that I changed after I attended Greg Young's <a href="http://www.jworks.nl/training/show/35/ddd-cqrs-training-course">DDD/CQRS training</a> is that I no longer allow my domain entities to enter an invalid state. So rather than having some kind of interceptor that does the validation as part of the persistency layer, all validation happens while making the changes:</p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#0000ff">public</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#0000ff">class</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#00008b">Agreement</font></span><span style="color: "> : </span></font><span style="color: "><font style="font-size: 11pt" color="#00008b">VersionedEntity</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#0000ff">public</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#0000ff">virtual</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#0000ff">string</font></span><span style="color: ">&#160;</span></font><span style="color: "><font style="font-size: 11pt" color="#800080">Title</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#008b8b">get</font></span><span style="color: "> { </span><span style="color: "><font color="#0000ff">return</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#800080">title</font></span></font><span style="color: "><font style="font-size: 11pt">; }</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="color: "><font style="font-size: 11pt" color="#008b8b">set</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#008b8b">EnsureChangesAreAllowed</font></span></font><span style="color: "><font style="font-size: 11pt">();</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: " lang="nl"><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#0000ff">if</font></span><span style="color: "> (</span><span style="color: "><font color="#0000ff">string</font></span><span style="color: ">.</span><span style="color: "><font color="#008b8b">IsNullOrEmpty</font></span><span style="color: ">(</span><span style="color: "><font color="#0000ff">value</font></span></font><span style="color: "><font style="font-size: 11pt">))</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#0000ff">throw</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#0000ff">new</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#00008b">RuleViolationException</font></span><span style="color: ">(</span><span style="color: "><font color="#a31515">&quot;A new agreement requires at least a title.&quot;</font></span></font><span style="color: "><font style="font-size: 11pt">);</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: " lang="nl"><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#800080">title</font></span><span style="color: "> = </span><span style="color: "><font color="#0000ff">value</font></span></font><span style="color: "><font style="font-size: 11pt">;</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160;&#160; }</font></font></p> <span style="color: "></span>  <p><span style="color: ">I’m currently using this approach in a client project, and admit I still have to build up more experience to see if you get away with this approach. Up to now it works for me, but I wouldn’t be surprised if I run into an exception (don’t we all?).</span></p>  <p><span style="color: ">As a side note, the VersionedEntity you see up here is just a base class including an Id and Version property for concurrency detection. Since most systems have some entities that rarely change (a.k.a. reference data), no version detection is necessary. Hence the difference between the Entity and VersionedEntity base classes.</span></p> <span style="color: "></span>  <p><span style="color: "></span>As mentioned before, I use NHibernate accompanied by <a href="https://sourceforge.net/projects/nhibernate/files">LINQ</a> and <a href="http://wiki.fluentnhibernate.org/show/HomePage">Fluent NHibernate</a>, but I still use the Repository pattern to hide all the LINQ stuff that goes on inside the repositories. The current request-specific ISession is tracked by a session manager class that the Command Handlers and Service Actions will create as part of their execution.</p>  <p>I know that I, at least for a while, advocated that all repository interfaces should expose IQueryable&lt;T&gt; so that you can easily execute LINQ queries from your higher layers. But I've found that testing that your code has created the proper LINQ query is virtually impossible, and now stick to exposing explicit well-named operations only. </p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#0000ff">public</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#0000ff">interface</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#00008b">IAgreementRepository</font></span><span style="color: "> : </span><span style="color: "><font color="#00008b">IRepository</font></span><span style="color: ">&lt;</span><span style="color: "><font color="#00008b">Agreement</font></span></font><span style="color: "><font style="font-size: 11pt">&gt;</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#00008b">Agreement</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#008b8b">Get</font></span><span style="color: ">(</span><span style="color: "><font color="#0000ff">long</font></span><span style="color: "> id, </span><span style="color: "><font color="#0000ff">long</font></span></font><span style="color: "><font style="font-size: 11pt"> version);</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#0000ff">void</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#008b8b">Add</font></span><span style="color: ">(</span><span style="color: "><font color="#00008b">Agreement</font></span></font><span style="color: "><font style="font-size: 11pt"> agreement);</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#0000ff">bool</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#008b8b">ExistsForCpiCaseNumber</font></span><span style="color: ">(</span><span style="color: "><font color="#0000ff">string</font></span></font><span style="color: "><font style="font-size: 11pt"> cpiCaseNumber);</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#00008b">IEnumerable</font></span><span style="color: ">&lt;</span><span style="color: "><font color="#00008b">AgreementValidityInCountry</font></span><span style="color: ">&gt; </span><span style="color: "><font color="#008b8b">Find            <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font face="Calibri"><font style="font-size: 11pt">&#160;&#160;&#160; </font></font></font></span><span style="color: ">(</span><span style="color: "><font color="#00008b">AgreementValidityPerCountrySpecification</font></span></font><span style="color: "><font style="font-size: 11pt"> specification);</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160;&#160; }</font></font></p>  <p>And now that I’m discussing repositories anyway, one recurring design issue is whether to allow an entity to access any repositories or other services. My personal opinion is a pragmatic one: yes, as long as the related dependency injection doesn’t affect the performance significantly (and yes, you need to measure that). If you don’t allow this, you may very well end up with an <a href="http://www.lostechies.com/blogs/derickbailey/archive/2010/09/22/domain-models-dependencies-and-fighting-anemia.aspx">anemic domain model</a>.</p>  <p>Another aspect of my domain model approach is that to prevent any unrelated logic creeping in a command handler just because a change to an aggregate root affects another aggregate, I use <a href="http://www.udidahan.com/2009/06/14/domain-events-salvation/">Udi'</a>s approach to raise Domain Events that are handled by Event Handlers. </p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#0000ff">public</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#0000ff">static</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#0000ff">class</font></span><span style="color: ">&#160;</span></font><span style="color: "><font style="font-size: 11pt" color="#00008b">DomainEvents</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160; [</font></span><font style="font-size: 11pt"><span style="color: "><font color="#00008b">ThreadStatic</font></span></font><span style="color: "><font style="font-size: 11pt">]</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#0000ff">private</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#0000ff">static</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#00008b">List</font></span><span style="color: ">&lt;</span><span style="color: "><font color="#00008b">Delegate</font></span><span style="color: ">&gt; </span><span style="color: "><font color="#800080">actions</font></span></font><span style="color: "><font style="font-size: 11pt">;</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: " lang="nl"><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#0000ff">public</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#0000ff">static</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#0000ff">void</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#008b8b">Register</font></span><span style="color: "> &lt;</span><span style="color: "><font color="#00008b">T</font></span><span style="color: ">&gt;(</span><span style="color: "><font color="#00008b">Action</font></span><span style="color: ">&lt;</span><span style="color: "><font color="#00008b">T</font></span><span style="color: ">&gt; callback) </span><span style="color: "><font color="#0000ff">where</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#00008b">T</font></span><span style="color: "> : </span></font><span style="color: "><font style="font-size: 11pt" color="#00008b">IDomainEvent</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#0000ff">if</font></span><span style="color: "> (</span><span style="color: "><font color="#800080">actions</font></span><span style="color: "> == </span><span style="color: "><font color="#0000ff">null</font></span></font><span style="color: "><font style="font-size: 11pt">)</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#800080">actions</font></span><span style="color: "> = </span><span style="color: "><font color="#0000ff">new</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#00008b">List</font></span><span style="color: ">&lt;</span><span style="color: "><font color="#00008b">Delegate</font></span></font><span style="color: "><font style="font-size: 11pt">&gt;();</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#800080">actions</font></span><span style="color: ">.</span><span style="color: "><font color="#008b8b">Add</font></span></font><span style="color: "><font style="font-size: 11pt">(callback);</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: " lang="nl"><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#0000ff">public</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#0000ff">static</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#0000ff">void</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#008b8b">ClearCallbacks</font></span></font><span style="color: "><font style="font-size: 11pt">()</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#800080">actions</font></span><span style="color: "> = </span><span style="color: "><font color="#0000ff">null</font></span></font><span style="color: "><font style="font-size: 11pt">;</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: " lang="nl"><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#0000ff">public</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#0000ff">static</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#0000ff">void</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#008b8b">Raise</font></span><span style="color: "> &lt;</span><span style="color: "><font color="#00008b">T</font></span><span style="color: ">&gt;(</span><span style="color: "><font color="#00008b">T</font></span><span style="color: "> args) </span><span style="color: "><font color="#0000ff">where</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#00008b">T</font></span><span style="color: "> : </span></font><span style="color: "><font style="font-size: 11pt" color="#00008b">IDomainEvent</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#0000ff">if</font></span><span style="color: "> (</span><span style="color: "><font color="#800080">actions</font></span><span style="color: "> != </span><span style="color: "><font color="#0000ff">null</font></span></font><span style="color: "><font style="font-size: 11pt">)</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#0000ff">foreach</font></span><span style="color: "> (</span><span style="color: "><font color="#00008b">Delegate</font></span><span style="color: ">&#160;</span><span style="color: ; font-weight: "><strong>action</strong></span><span style="color: ">&#160;</span><span style="color: "><font color="#0000ff">in</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#800080">actions</font></span></font><span style="color: "><font style="font-size: 11pt">)</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#0000ff">if</font></span><span style="color: "> (</span><span style="color: ; font-weight: "><strong>action</strong></span><span style="color: ">&#160;</span><span style="color: "><font color="#0000ff">is</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#00008b">Action</font></span><span style="color: ">&lt;</span><span style="color: "><font color="#00008b">T</font></span></font><span style="color: "><font style="font-size: 11pt">&gt;)</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ((</font></span><font style="font-size: 11pt"><span style="color: "><font color="#00008b">Action</font></span><span style="color: ">&lt;</span><span style="color: "><font color="#00008b">T</font></span><span style="color: ">&gt;) </span><span style="color: ; font-weight: "><strong>action</strong></span></font><span style="color: "><font style="font-size: 11pt">)(args);</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160; }</font></font></p>  <p>If you want to subscribe to a particular event, do this:</p>  <p><font face="Calibri"><span style="line-height: normal; color: "><font color="#00008b"><font style="font-size: 11pt">DomainEvents</font></font></span><font style="font-size: 11pt"><span style="line-height: normal; color: ">.</span><span style="line-height: normal; color: "><font color="#008b8b">Register</font></span><span style="line-height: normal; color: ">&lt;</span><span style="line-height: normal; color: "><font color="#00008b">StockCorrectedEvent</font></span><span style="line-height: normal; color: ">&gt;(</span><span style="line-height: normal; color: "><font color="#800080">StockCorrectedHandler</font></span><span style="line-height: normal; color: ">.</span><span style="line-height: normal; color: "><font color="#008b8b">Handle</font></span></font><span style="line-height: normal; color: "><font style="font-size: 11pt">);</font></span></font></p>  <p>Where the method reference resolves to an Event Handler class that implements this interface.</p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#0000ff">public</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#0000ff">interface</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#00008b">IHandle</font></span><span style="color: ">&lt;</span><span style="color: "><font color="#00008b">T</font></span><span style="color: ">&gt; </span><span style="color: "><font color="#0000ff">where</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#00008b">T</font></span><span style="color: "> : </span></font><span style="color: "><font style="font-size: 11pt" color="#00008b">IDomainEvent</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160; {</font></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; font-size: "><font face="Calibri"><span style="color: "><font style="font-size: 11pt">&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 11pt"><span style="color: "><font color="#0000ff">void</font></span><span style="color: ">&#160;</span><span style="color: "><font color="#008b8b">Handle</font></span><span style="color: ">(</span><span style="color: "><font color="#00008b">T</font></span></font><span style="color: "><font style="font-size: 11pt"> args);</font></span></font></p>  <p style="line-height: normal; margin: 0in; font-family: ; color: ; font-size: "><font face="Calibri"><font style="font-size: 11pt">&#160;&#160; }</font></font></p>  <p>To raise a domain event from inside your domain entity, simply call the Raise method like this:</p>  <p><font face="Calibri"><span style="line-height: normal; color: "><font color="#00008b"><font style="font-size: 11pt">DomainEvents</font></font></span><font style="font-size: 11pt"><span style="line-height: normal; color: ">.</span><span style="line-height: normal; color: "><font color="#008b8b">Raise</font></span><span style="line-height: normal; color: ">(</span><span style="line-height: normal; color: "><font color="#0000ff">new</font></span><span style="line-height: normal; color: ">&#160;</span><span style="line-height: normal; color: "><font color="#00008b">StockCorrectedEvent</font></span><span style="line-height: normal; color: ">(</span><span style="line-height: normal; color: "><font color="#0000ff">this</font></span></font><span style="line-height: normal; color: "><font style="font-size: 11pt">, location, originalAmount, newAmount));</font></span></font></p>  <p>Next time I'll dive into the details of my Silverlight client application and my usage of Model-View-ViewModel and the <a href="http://caliburnmicro.codeplex.com/">Caliburn Micro</a> framework.</p>  