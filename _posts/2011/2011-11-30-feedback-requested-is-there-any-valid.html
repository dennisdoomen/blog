---

title: 'Feedback Requested: Is there any valid usage for the ‘new’ keyword?'
date: '2011-11-30T19:50:00.001+01:00'

tags:
- dotnetmag
- C#
- Coding Guidelines
modified_time: '2011-11-30T19:50:19.743+01:00'
blogger_id: tag:blogger.com,1999:blog-15137028.post-3465801355493624643
blogger_orig_url: http://www.continuousimprover.com/2011/11/feedback-requested-is-there-any-valid.html
---

<p>Yesterday I ended up being part of a discussion about using the ‘new’ keyword to hide base-class members. A colleague of mine used it to alter a base-class property in a derived class with the purpose of making it more strongly typed. </p> <p>I’ve always rationalized guideline AV1010 (<em>Don’t hide inherited members with the new keyword</em>) by referring to the <a href="http://www.objectmentor.com/resources/articles/lsp.pdf">Liskov Substitution Principle</a> and claiming that if you need it, then you’re probably facing a design smell. In this particular case that was indeed the issue, so after fixing it, the keyword wasn’t necessary at all. </p> <p>But, his arguments did make sense. In fact, he was so convinced about it that he sent me a proposal for an exception to the <a href="http://csharpguidelines.codeplex.com/">C# Coding Guidelines</a>. As part of the discussion, he also sent me some <a href="http://blogs.msdn.com/b/ericlippert/archive/2008/05/21/method-hiding-apologia.aspx">background info</a> on the keyword’s origin by C# co-author <a href="http://blogs.msdn.com/b/ericlippert/">Eric Lippert</a>. </p> <p>This is the example he claims is a valid and useful exception to the guideline. The purpose was to ensure that a manager always has a smart phone rather than any other type of phone.</p><pre class="csharpcode">    <span class="kwrd">public</span> <span class="kwrd">class</span> Phone<br />    {<br />    }<br /> <br />    <span class="kwrd">public</span> <span class="kwrd">class</span> SmartPhone : Phone<br />    {<br />    }<br /> <br />    <span class="kwrd">public</span> <span class="kwrd">class</span> Employee<br />    {<br />        <span class="kwrd">public</span> Employee(Phone phone)<br />        {<br />            Phone = phone;<br />        }<br /> <br />        <span class="kwrd">public</span> <span class="kwrd">virtual</span> Phone Phone { get; }<br />    }<br /> <br />    <span class="kwrd">public</span> <span class="kwrd">class</span> Manager : Employee<br />    {<br />        <span class="kwrd">public</span> Manager(SmartPhone phone) : <span class="kwrd">base</span>(phone)<br />        {<br />        }<br /> <br />        <span class="kwrd">public</span> <span class="kwrd">new</span> <span class="kwrd">virtual</span> SmartPhone Phone<br />        {<br />            get { <span class="kwrd">return</span> (SmartPhone)<span class="kwrd">base</span>.Phone; }<br />        }<br />    }</pre><br /><p>As far as I see it, the Manager class is violating the contract defined by the Employee class, and thus violates the LSP. If an employee can have any type of phone, and a Manager cannot, than clearly, a Manager is <strong>not</strong> an Employee. They may share some characteristics, but that might be solved by a common base-class. </p><br /><p><img style="display: block; float: none; margin-left: auto; margin-right: auto" title="Small Liskov Substitution Principle poster" border="0" alt="Small Liskov Substitution Principle poster" src="http://www.globalnerdy.com/wordpress/wp-content/uploads/2009/07/liskov_substitution_principle_small.jpg" width="450" height="338"></p><br /><p>I don’t easily loosen guidelines unless there’s a really sensible exception, but I do like to give any suggestion serious consideration. So please provide me your feedback. Is there any valid reason for using the ‘new’ keyword other than for legacy purposes (where you can’t change some base-class code) and which is not a design smell? </p><br /><p>Let me know by commenting on this post, by sending me <a href="mailto:dennis.doomen@avivasolutions.nl">email</a> or <a href="http://twitter.com/#!/ddoomen">tweeting</a> me at @ddoomen.</p>  