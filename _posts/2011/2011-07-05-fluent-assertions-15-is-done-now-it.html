---

title: Fluent Assertions 1.5 is done! Now it's time for that summer.
date: '2011-07-05T13:04:00.001+02:00'

tags:
- Fluent Assertions
- dotnetmag
- C#
- Testing
modified_time: '2011-07-05T13:11:24.001+02:00'
thumbnail: http://lh5.ggpht.com/-GrIOy-AjhSA/ThLvsAAq1KI/AAAAAAAAIgk/VK8WC2J1RIk/s72-c/clip_image001%25255B8%25255D_thumb%25255B2%25255D.jpg?imgmax=800
blogger_id: tag:blogger.com,1999:blog-15137028.post-1464976966832876428
blogger_orig_url: http://www.continuousimprover.com/2011/07/fluent-assertions-15-is-done-now-it.html
---

<p>In the last couple of months, me and colleague <a href="http://twitter.com/#!/mpopdam">Martin Opdam</a> have spent a considerable amount of time on both improving the reporting capabilities of Fluent Assertions as well as fixing and incorporating various community contributions. Because of the many changes required, a very busy client project, and my endeavors around moving to a new house, it took us over four months to complete the next version. So let's quickly highlight the changes.  <p><a href="http://lh4.ggpht.com/-nNwLyxwQSsk/ThLvrm4TW4I/AAAAAAAAIgg/ftgcGAZSASI/s1600-h/clip_image001%25255B8%25255D%25255B4%25255D.jpg"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="clip_image001[8]" border="0" alt="clip_image001[8]" src="http://lh5.ggpht.com/-GrIOy-AjhSA/ThLvsAAq1KI/AAAAAAAAIgk/VK8WC2J1RIk/clip_image001%25255B8%25255D_thumb%25255B2%25255D.jpg?imgmax=800" width="265" height="151"></a>  <p><strong>So what's new?</strong>  <p>A contributor working under the CodePlex account <a href="http://www.codeplex.com/site/users/view/MatFiz">MatFiz</a> added the missing counterpart of <font face="Courier New">string.Should().Contain()</font>, consistently named <font face="Courier New">string.Should().NotContain()</font>. And while he was doing that, he also included the case-insensitive versions <font face="Courier New">string.Should().ContainEquivalentOf()</font> and <font face="Courier New">string.Should().NotContainEquivalentOf()</font>. He also included fluent equivalents of <font face="Courier New">string.IsNullOrWhiteSpace()</font> through <font face="Courier New">string.Should().BeBlank()</font> and <font face="Courier New">string.Should().NotBeBlank()</font>.  <p>Asserting that a string matches a particular wildcard pattern can now be done using <font face="Courier New">string.Should().Match()</font> and the case-insensitive <font face="Courier New">MatchEquivalentOf()</font>, both supporting the familiar * and ? Characters. You might wonder why we choose for ordinary wildcards rather than Regular Expressions, and the answer has everything to do with keeping your tests intention revealing. I haven't met a lot of developers that know all the regex escape codes by heart. But I do know a few that are capable of writing with some very obscure (but technically correct) expressions. And that isn't going to help the majority of the developers.  <p>Another request involved asserting that an object can be serialized and then deserialized using the binary or XML formatters. I never felt the need for something like that, but I decided to include the <font face="Courier New">object.Should().BeBinarySerializable()</font> and <font face="Courier New">object.Should().BeXmlSerializable()</font> anyhow. Both of them will serialize an object to a MemoryStream using the corresponding serializer and then use FA's property comparison assertions to compare the properties of the deserialized object with the original object. Notice that this works only for objects that support full round-trip serialization.  <p>While Martin introduced the possibility to execute various assertions on <font face="Courier New">IDictionary&lt;T&gt;</font>, including checking for specific keys, values or a combination of both, at roughly the same time I added support for <font face="Courier New">IComparable&lt;T&gt;</font> through methods such as <font face="Courier New">comparable.Should().BeLessThan()</font>, <font face="Courier New">BeGreaterOrEqual()</font>, <font face="Courier New">BeNull()</font> or <font face="Courier New">BeInRange()</font>.  <p>One of the things I've always have been annoyed with is the fact that when you assert that an exception was thrown with a particular exception message, you had to specify the entire message, including punctuation and whitespace. But usually I don't really care about the specifics, and only need to ensure myself that parts of the message match. But since we've introduced wildcard-based string matching in this release anyway, it didn't require a lot of work to support this:<br><br> <p style="line-height: normal; margin: 0in; font-family: "><font face="Calibri"><span style="color: "><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&nbsp; </font></span><font style="font-size: 11pt">action.</font></font></span><font style="font-size: 11pt"><span style="color: "><font color="#008b8b">ShouldThrow</font></span><span style="color: "><font color="#000000">&lt;</font></span><span style="color: "><font color="#00008b">ArgumentOutOfRangeException</font></span></font></font><font face="Calibri"><font style="font-size: 11pt"><span style="color: "><font color="#000000">&gt;().</font></span><span style="color: "><font color="#008b8b">WithMessage</font></span><span style="color: "><font color="#000000">(</font></span></font></font></p> <p style="line-height: normal; margin: 0in; font-family: "><font face="Calibri"><font style="font-size: 11pt"><span style="color: "></span><span style="color: "><font color="#a31515"></font></span><span style="color: "><font color="#a31515"></font></span><span style="color: "><font color="#a31515">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "code InvalidCode does not match a known"</font></span><span style="color: "><font color="#000000">, </font></span><span style="color: "><font color="#00008b">ComparisonMode</font></span><span style="color: "><font color="#000000">.</font></span><span style="color: "><font color="#800080"><strong>Substring</strong></font></span></font><span style="color: "><font style="font-size: 11pt" color="#000000">);</font></span></font></p> <p>Or this:<br><br> <p style="line-height: normal; margin: 0in; font-family: "><font face="Calibri"><span style="color: "><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&nbsp; </font></span><font style="font-size: 11pt">action.</font></font></span><font style="font-size: 11pt"><span style="color: "><font color="#008b8b">ShouldThrow</font></span><span style="color: "><font color="#000000">&lt;</font></span><span style="color: "><font color="#00008b">AssertFailedException</font></span></font></font><font face="Calibri"><font style="font-size: 11pt"><span style="color: "><font color="#000000">&gt;().</font></span><span style="color: "><font color="#008b8b">WithMessage</font></span><span style="color: "><font color="#000000">(<br></font></span><span style="color: "><font color="#a31515">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Expected object*World*to be less than*City*because a city is smaller than the world."</font></span></font><span style="color: "><font style="font-size: 11pt" color="#000000">,</font></span></font></p> <p style="line-height: normal; margin: 0in; font-family: "><font face="Calibri"><span style="color: "><font color="#00008b"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 11pt">ComparisonMode</font></font></span><font style="font-size: 11pt"><span style="color: "><font color="#000000">.</font></span><span style="color: "><font color="#800080"><strong>Wildcard</strong></font></span></font><span style="color: "><font style="font-size: 11pt" color="#000000">);</font></span></font></p> <p>Another little neat new feature is a fluent API for specifying dates and times. For example, consider this.<br><br> <p style="line-height: normal; margin: 0in; font-family: "><font face="Calibri"><span style="color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&nbsp; </font></span><font style="font-size: 11pt">var</font></font></span><font style="font-size: 11pt"><span style="color: "><font color="#000000"> period = </font></span><span style="color: "><font color="#0000ff">new</font></span><span style="color: "><font color="#000000">&nbsp;</font></span><span style="color: "><font color="#00008b">Period</font></span><span style="color: "><font color="#000000">(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new </font></span><span style="color: "><font color="#00008b">DateTime</font></span><span style="color: "><font color="#000000">(2011, 2, 1, 8, 0, 0), new </font></span><span style="color: "><font color="#00008b">DateTime</font></span><span style="color: "><font color="#000000">(2011, 2, 1, 18, 00)); </font></span><span style="color: "><span style="mso-spacerun: yes"><font color="#0000ff">&nbsp; </font></span></span></font><span style="color: "><font style="font-size: 11pt" color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></font></p> <p>If you're into fluent interfaces like me (if not, why would you be here anyway :-)), this is a much better read, don't you think?<br><br> <p style="line-height: normal; margin: 0in; font-family: "><font face="Calibri"><span style="color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&nbsp; </font></span><font style="font-size: 11pt">var</font></font></span><font style="font-size: 11pt"><span style="color: "><font color="#000000"> period = </font></span><span style="color: "><font color="#0000ff">new</font></span><span style="color: "><font color="#000000">&nbsp;</font></span><span style="color: "><font color="#00008b">Period</font></span><span style="color: "><font color="#000000">(1.</font></span><span style="color: "><font color="#008b8b">February</font></span><span style="color: "><font color="#000000">(2011).</font></span><span style="color: "><font color="#008b8b">At</font></span><span style="color: "><font color="#000000">(08, 00), 1.</font></span><span style="color: "><font color="#008b8b">February</font></span><span style="color: "><font color="#000000">(2011).</font></span><span style="color: "><font color="#008b8b">At</font></span></font><span style="color: "><font style="font-size: 11pt" color="#000000">(18, 00));</font></span></font></p> <p><strong>What property?</strong>  <p>Because I don't like spending time in my debugger, the majority of this release was spent on the reporting side. I've tried to make sure that FA reports failures as clear and intention revealing as possible.  <p>For instance, <font face="Courier New">object.ShouldHave().AllProperties().EqualTo(object)</font> now internally uses the equality assertions appropriate for the type of property. This significantly improves the details reported for a string or <font face="Courier New">IEnumerable&lt;T&gt;</font> property.  <p><a href="http://lh5.ggpht.com/-w9RJpC-QCus/ThLvsmgshHI/AAAAAAAAIgo/P5jslAsgfC4/s1600-h/clip_image002%25255B6%25255D%25255B4%25255D.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="clip_image002[6]" border="0" alt="clip_image002[6]" src="http://lh6.ggpht.com/-cpuYPUQGdmE/ThLvtFI3JoI/AAAAAAAAIgs/v-fNEOhQn_M/clip_image002%25255B6%25255D_thumb%25255B2%25255D.png?imgmax=800" width="473" height="47"></a>  <p>The property assertion also throws with a clearer explanation when the types of equally named properties are not convertible.  <p><strong>Where's the difference?</strong>  <p>Another area that has been improved is the way string differences are reported. This applies both to exception message assertions as well as direct string comparisons. The exception assertions will always display the expected and the actual messages on separate lines so that it is easier to spot the difference.  <p><a href="http://lh6.ggpht.com/-EGQMdzSbRtc/ThLvt7y0AkI/AAAAAAAAIgw/Lf7pLLzJfhE/s1600-h/clip_image003%25255B6%25255D%25255B5%25255D.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="clip_image003[6]" border="0" alt="clip_image003[6]" src="http://lh3.ggpht.com/-Wbb_-Tsa2QI/ThLvufN3SII/AAAAAAAAIg0/XXy06AAW-nU/clip_image003%25255B6%25255D_thumb%25255B3%25255D.png?imgmax=800" width="565" height="64"></a>  <p>String assertions will do the same, but only if one of the involved strings contains a newline or is longer than 6 characters. As you've probably already noticed, line breaks and other special characters are escaped now.  <p><strong>An object is not an object</strong>  <p>Something I already benefited from during dogfooding an intermediate release in a client project is that FA will now display the public properties of the involved objects whenever an assertion failure occurs.  <p><a href="http://lh4.ggpht.com/-UHWsmDARJOY/ThLvu1NSmWI/AAAAAAAAIg4/Loi2muHQoKc/s1600-h/clip_image004%25255B6%25255D%25255B3%25255D.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="clip_image004[6]" border="0" alt="clip_image004[6]" src="http://lh6.ggpht.com/-X955dhS_1Ko/ThLvvG_f_9I/AAAAAAAAIg8/Xt2iTf1BHmE/clip_image004%25255B6%25255D_thumb%25255B1%25255D.png?imgmax=800" width="193" height="240"></a>  <p>Before this change, the only thing you got was a message along the line of "Expected object <em>classname</em> to be equal to <em>classname</em>, but they weren't". This will surely help tracking down the problem in your production code. And notice, FA will only do this if the object involved doesn't override <font face="Courier New">ToString()</font>. And since the collection assertions now use the same formatting infrastructure as the rest of FA, collections of objects will also be displayed using the actual structure of the object. In fact, it even support nested collections.  <p><strong>Did I break anything?</strong>  <p>Upon specific request from a current user, I did change the behavior of the <font face="Courier New">collection.Be(Not)SubsetOf()</font> method so that an empty set is now treated as a subset of any set. Something similar happened to the <font face="Courier New">collection.Be(Not)EquivalentTo()</font> method; an empty set is now treated as equivalent to another empty set. So if you find that some of your tests start to fail after the upgrade, make sure they don't rely on this behavior.  <p>Also, if you have been extending FA using the <font face="Courier New">Execute</font> class, pay particular attention to the <a href="http://fluentassertions.codeplex.com/releases/view/65187">release notes</a>. We've changed the way you need to refer to the because of an assertion and marked the old API as obsolete.  <p><strong>How do I get started?</strong>  <p>Just install <a href="http://nuget.org/">NuGet</a> and download the latest version of Fluent Assertions from its <a href="http://nuget.org/List/Packages/fluentassertions">corresponding</a> NuGet page. If don't want to use NuGet, then download it from <a href="http://fluentassertions.codeplex.com/releases/view/65187">CodePlex</a> directly.    