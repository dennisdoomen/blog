---

title: Moving to Visual Studio 2008 and Team Foundation Server 2008
date: '2008-01-11T07:35:00.001+01:00'

tags: 
modified_time: '2008-01-11T07:35:43.543+01:00'
thumbnail: http://lh3.google.com/dennis.doomen/R4cOPl2dGnI/AAAAAAAABAg/HLWyAvGLoS4/s72-c/image_thumb%5B2%5D?imgmax=800
blogger_id: tag:blogger.com,1999:blog-15137028.post-7858097824276311181
blogger_orig_url: http://www.continuousimprover.com/2008/01/moving-to-visual-studio-2008-and-team.html
---

<p>During the Christmas holiday, I started migrating my customer's development environment to the newest set of Microsoft development products. We already planned to do this a bit earlier, but since we had to wait for the <a href="http://www.codeplex.com/servicefactory/Release/ProjectReleases.aspx?ReleaseId=8130">first VS2008 CTP</a> of the Patterns &amp; Practices Web Service Software Factory : Modeling Edition, we simply couldn't. We are now two weeks further, so I decided to share some my experiences since then.  <p align="center"><a href="http://lh4.google.com/dennis.doomen/R4cOO12dGmI/AAAAAAAABAY/TGkuAtXnEQw/image%5B4%5D?imgmax=800"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="277" alt="image" src="http://lh3.google.com/dennis.doomen/R4cOPl2dGnI/AAAAAAAABAg/HLWyAvGLoS4/image_thumb%5B2%5D?imgmax=800" width="351" border="0"></a> </p> <p><strong>General</strong>  <ul> <li>Well, I did not ran into any problems after the upgrade to .NET 3.5 while converting the existing Visual Studio 2005 solutions. I know about the advice to first upgrade the solutions, and then plan the introduction to .NET 3.5, but I couldn't resist.  <li>If you choose to upgrade your solution to .NET 3.5 during the automatic conversion, it seems that only the web application projects (or web site projects) are modified to target .NET 3.5. I'm not entirely sure about this, but at least, that is what I've observed. Unfortunately, you have to go through each and every project one by one and change its framework version.  <li>Beware that if you upgrade an existing ASP.NET 2.0 web site (or web application) to .NET 3.5, Visual Studio will automatically add an assembly redirect to your web.config that forwards any dependencies on the 1.0.61025.0 version of the System.Web.Extensions assembly to the corresponding .NET 3.5 assemblies. We did not notice any differences (yet), but if you do, you may need look in that area. All our existing control libraries (Obout, Telerik and the ASP.NET Ajax Control Toolkit) kept working without a glitch. There is a .NET 3.5-specific update of the <a href="http://www.asp.net/ajax/ajaxcontroltoolkit/samples/">AJAX Control Toolkit</a> though.  <li>You can't update existing WCF Service References (the .map files created from within VS2005) anymore. You need to re-add the reference from scratch. See <a href="http://blogs.msdn.com/lifenglu/archive/2007/05/08/files-in-a-service-wcf-references.aspx">this post</a> for more information.  <li>Although the installation of .NET 3.5 should not cause any troubles, we did not notice an anomaly after we installed Visual Studio 2008 next to Visual Studio 2005. The reason for this is that .NET 3.5 installer also installs two service packs on top of .NET 2.0 and 3.0. Apparently, we were using something that was wrong in the first place, but not detected by the compiler. Lucky, we invested heavily in unit tests and this one issue surfaced almost immediately.  <li>The best thing you should do after upgrading to Visual Studio 2008 is read about LINQ. We are using Nhibernate in our data access layer and don't need LINQ-to-SQL, but still, LINQ is the best thing since Generics. Even if you don't like the query expression, simply include the System.Linq namespace and enjoy the power of the many extension methods it adds to your arrays, lists and other collection classes. </li></ul> <p><strong>Add-ins &amp; Tools</strong>  <ul> <li>Beware that the <a href="http://www.microsoft.com/Downloads/details.aspx?familyid=C0A394C0-5EEB-47C4-9F7B-71E51866A7ED&amp;displaylang=en">Guidance Automation Extensions</a> installer can only be installed once. You either have to choose to install it on Visual Studio 2005 or on Visual Studio 2008, but not both. Consider that if you're thinking about gradially migrating to 2008.  <li>The <a href="http://www.codeplex.com/websf">Web Client Software Factory</a> does not officially work with VS2008 yet, but it appeared that the hack suggested by this <a href="http://staff.southworks.net/blogs/ejadib/archive/2007/10/08/How_2D00_To_3A00_-Web-Client-Software-Factory-_2800_WCSF_2900_-_2600_-Visual-Studio-Orcas-Beta-2.aspx">knowledge base article</a> works quite well. A more official version is expected in <a href="http://blogs.msdn.com/gblock/archive/2007/12/13/we-re-revving-scsf-and-wcsf-for-vs2008.aspx">February</a>.  <li>I discovered that the same trick also works for the Enterprise Library 3.1 installer. Obviously, EntLib is not compiled to .NET 3.5, but up to now, I did not find any issues related to that. Since the only changes with respect to EntLib is the service pack that the .NET Framework 3.5 installer applies to .NET Framework 2.0  <li>The <a href="http://www.codeplex.com/TFSAdmin">TFS Administration Tool</a> is a beautiful little commodity that allows you to add or remove user accounts from TFS, WSS and SQL Reporting Services in a single click. Unfortunately, if you chose to upgrade Windows Sharepoint Services to 3.0 while upgrading from TFS 2005 to 2008, the tool does not work with WSS 3.0. For the time being, you have to fall back on the WSS Site Settings, but this will change <a href="http://www.codeplex.com/TFSAdmin/Thread/View.aspx?ThreadId=18228">soon</a>.  <li>After installing the Guidance Automation Extensions of May 2007 and the software factories, some of my colleagues using the Team Developer edition of Visual Studio 2008 ran into multiple occurrences of the "System.IO.FileLoadException: Could not load file or assembly 'Microsoft.VisualStudio.TemplateWizardInterface, Version=9.0.0.0". As explained in <a href="http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=2232094&amp;SiteID=1">this post</a>, removing a single redirect from the devenv.exe.config solved the problem. It did not occur on a Team Suite install.  <li>I personally believe that JetBrains' <a href="http://www.jetbrains.com/resharper/download/index.html">Resharper</a> is the very best tool since Visual Studio. Version 3.1 does work with Visual Studio 2008, but its excellent code analysis features have some trouble with the new C# 3.0 keywords. Until the <a href="http://www.jetbrains.net/confluence/display/ReSharper/ReSharper+4.0+Roadmap">Early Access Program</a> for Resharper 4.0 opens, I found an acceptable workaround that gives (most of) the best of both worlds. <br>Simply disable Resharper's Code Analysis function and let it use Visual Studio's Intellisense . You may have to re-enable the IntelliSense settings under Tools-&gt;Options-&gt;Text Editor-&gt;C#-&gt;IntelliSense. Even though Visual Studio's IntelliSense cannot compete with Resharper's, assigning the Alt-Enter keyboard shortcut to View.ShowSmartTag gives you a bit of Resharper-style behavior.</li></ul> <p><strong>Unit testing &amp; Team Build</strong>  <ul> <li>After upgrading, we noticed that while running unit tests, the Enterprise Library Logging Application Block could not find its enterpriselibrary.config (we moved the EntLib settings into a dedicated .config). At first, I thought it was a compatibility issue between .NET 3.5 and EntLib, but we also noticed that log4net was suffering from the same thing. After further investigation, I discovered that this is in fact a <a href="http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=2521419&amp;SiteID=1">bug</a> in Visual Studio 2008. As a workaround, we now have every test start with the following hack.<br>AppDomain.CurrentDomain.SetData("APPBASE", Environment.CurrentDirectory);  <li>Right after upgrading your test project, you may notice that the ExpectedException attribute does not seem to work anymore. This usually happens because your test project will still try to load version 8.x of the Microsoft.VisualStudio.QualityTools.UnitTestFramework assembly (which is part of Visual Studio 2005). Simply remove it and then reference the correct version 9.x of the assembly again. See also this <a href="http://www.ademiller.com/blogs/tech/2008/01/gotchas-upgrading-your-unit-test-projects-to-vs-2008/">post</a> for more information.  <li>If you have, like me, set-up your own workspaces from within your Team Build .proj file, you can now remove this stuff. The Build Definition dialog box allows configuring exactly which part of your source control tree should be included in the build.  <li>In Visual Studio 2005, it was not possible to configure Team Build to run all the unit tests part of an assembly without falling back on a .vsdmi test file. However, Buck Hodges provided a nice <a href="http://blogs.msdn.com/buckh/archive/2006/11/04/how-to-run-tests-without-test-metadata-files-and-test-lists-vsmdi-files.aspx">replacement</a> for MSBuild's TestToolsTask that did the job quite nice. Fortunately, Microsoft integrated this functionality into Team Foundation Server 2008 out of the box. Simply define an &lt;ItemGroup&gt; with a &lt;TestCountainer&gt; that includes a wildcard pattern for the assemblies that should be included. For instance:<br>&lt;TestContainer Include="$(OutDir)\%2a%2a\%2aTest.dll" /&gt;  <li>Don't forget to go to Tools-&gt;Options-&gt;Test Tools-&gt;Test Execution and limit the number of Test Results during unit testing. Oh, and check out the new shortcut keys for starting/debugging the unit tests visible within the current context.</li></ul> <p>Obviously, this is not all. During the next weeks, I'll try to update this post with new experiences and solutions to common issues.</p>  